<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.9.1"/>
<title>SLAMflex SE: libSLAMflex -  android project/jni/PatchFinder.cpp Source File</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="../../thumbnail.png"/></td>
  <td style="padding-left: 0.5em;">
   <div id="projectname">SLAMflex SE
   &#160;<span id="projectnumber">0.1.0</span>
   </div>
   <div id="projectbrief">SLAMflex provides detection and tracking of dominant planes for smartphone devices. This plane can then be used to show AR content relative to the plane orientation. The detection of plane is performed in the field of view of the smartphone camera. In subsequent frames it is tracked. The interface returns the plane position and orientation.</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.9.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "../../search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="../../index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="../../pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="../../modules.html"><span>Modules</span></a></li>
      <li><a href="../../namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="../../annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="../../files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="../../search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="../../search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="../../files.html"><span>File&#160;List</span></a></li>
      <li><a href="../../globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="../../dir_64138f433da6323d37c35d94c20fed44.html">libSLAMflex -  android project</a></li><li class="navelem"><a class="el" href="../../dir_f496a2d090f5040e1d0b8f142d0646a8.html">jni</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">PatchFinder.cpp</div>  </div>
</div><!--header-->
<div class="contents">
<a href="../../d8/d75/a00555.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">// Copyright 2008 Isis Innovation Limited</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d6/d95/a00556.html">PatchFinder.h</a>&quot;</span></div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../de/dde/a00587.html">SmallMatrixOpts.h</a>&quot;</span></div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d7/d41/a00532.html">KeyFrame.h</a>&quot;</span></div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;</div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../dd/dc0/a00611.html">vision.h</a>&quot;</span></div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../da/d6e/a00610.html">vector_image_ref.h</a>&quot;</span></div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d9/d44/a00527.html">image_interpolate.h</a>&quot;</span></div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../dd/d9c/a00487.html">Cholesky.h</a>&quot;</span></div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment">// tmmintrin.h contains SSE3&lt;&gt; instrinsics, used for the ZMSSD search at the bottom..</span></div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment">// If this causes problems, just do #define CVD_HAVE_XMMINTRIN 0</span></div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="preprocessor">#if CVD_HAVE_XMMINTRIN</span></div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="preprocessor">#include &lt;tmmintrin.h&gt;</span></div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;</div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="keyword">using namespace </span><a class="code" href="../../de/d85/a00618.html">CVD</a>;</div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="keyword">using namespace </span><a class="code" href="../../d4/d2a/a00632.html">std</a>;</div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;</div>
<div class="line"><a name="l00019"></a><span class="lineno"><a class="line" href="../../d7/df2/a00312.html#a37582462db3e8284d4df8dffa867b9a5">   19</a></span>&#160;<a class="code" href="../../d7/df2/a00312.html#a37582462db3e8284d4df8dffa867b9a5">PatchFinder::PatchFinder</a>(<span class="keywordtype">int</span> nPatchSize)</div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;  : mimTemplate(<a class="code" href="../../d7/da0/a00198.html">ImageRef</a>(nPatchSize,nPatchSize))</div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;{</div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;  <a class="code" href="../../d7/df2/a00312.html#a9ac41a306b23e4df6c99240354c7cfe4">mnPatchSize</a> = nPatchSize;</div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;  <a class="code" href="../../d7/df2/a00312.html#a29d8d47e0bd193dc4d590f6560255d35">mirCenter</a> = <a class="code" href="../../d7/da0/a00198.html">ImageRef</a>(nPatchSize/2, nPatchSize/2);</div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;  <span class="keywordtype">int</span> <a class="code" href="../../dd/d4d/a00519.html#a5409e0f5857087147caf55556c36ff22">nMaxSSDPerPixel</a> = 500; <span class="comment">// Pretty arbitrary... could make a GVar out of this.</span></div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;  <a class="code" href="../../d7/df2/a00312.html#a4cbaa59c947171f27fafe5fcd0523ba0">mnMaxSSD</a> = <a class="code" href="../../d7/df2/a00312.html#a9ac41a306b23e4df6c99240354c7cfe4">mnPatchSize</a> * <a class="code" href="../../d7/df2/a00312.html#a9ac41a306b23e4df6c99240354c7cfe4">mnPatchSize</a> * <a class="code" href="../../dd/d4d/a00519.html#a5409e0f5857087147caf55556c36ff22">nMaxSSDPerPixel</a>;</div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;  <span class="comment">// Populate the speed-up caches with bogus values:</span></div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;  <a class="code" href="../../d7/df2/a00312.html#aa9a76dbd2f6fb66e700ab7cffebc881d">mm2LastWarpMatrix</a> = 9999.9 * <a class="code" href="../../d0/de7/a00523.html#a33cfd229bb53b4055e430bd993782d41">Identity</a>;</div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;  <a class="code" href="../../d7/df2/a00312.html#abf22298b0275d53b8db8e21651f5cc19">mpLastTemplateMapPoint</a> = NULL;</div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;};</div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;</div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;</div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;<span class="comment">// Find the warping matrix and search level</span></div>
<div class="line"><a name="l00033"></a><span class="lineno"><a class="line" href="../../d7/df2/a00312.html#a5229e920912bc780042293dd184dea66">   33</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="../../d7/df2/a00312.html#a5229e920912bc780042293dd184dea66">PatchFinder::CalcSearchLevelAndWarpMatrix</a>(<a class="code" href="../../d9/d21/a00240.html">MapPoint</a> &amp;p,</div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;                          <a class="code" href="../../df/d73/a00358.html">SE3&lt;&gt;</a> se3CFromW,</div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;                          <a class="code" href="../../d6/db6/a00241.html">Matrix&lt;2&gt;</a> &amp;m2CamDerivs)</div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;{</div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;  <span class="comment">// Calc point pos in new view camera frame</span></div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;  <span class="comment">// Slightly dumb that we re-calculate this here when the tracker&#39;s already done this!</span></div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;  <a class="code" href="../../d9/d69/a00451.html">Vector&lt;3&gt;</a> v3Cam = se3CFromW * p.<a class="code" href="../../d9/d21/a00240.html#a03926fa19108aea2b524e8a244853eb7">v3WorldPos</a>;</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;  <span class="keywordtype">double</span> dOneOverCameraZ = 1.0 / v3Cam[2];</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;  <span class="comment">// Project the source keyframe&#39;s one-pixel-right and one-pixel-down vectors into the current view</span></div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;  <a class="code" href="../../d9/d69/a00451.html">Vector&lt;3&gt;</a> v3MotionRight = se3CFromW.<a class="code" href="../../df/d73/a00358.html#a6f349984d701630586ac4955c35733f7">get_rotation</a>() * p.<a class="code" href="../../d9/d21/a00240.html#ab3effcd7c9d1c6b8ad36c900fa36f391">v3PixelRight_W</a>;</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;  <a class="code" href="../../d9/d69/a00451.html">Vector&lt;3&gt;</a> v3MotionDown = se3CFromW.<a class="code" href="../../df/d73/a00358.html#a6f349984d701630586ac4955c35733f7">get_rotation</a>() * p.<a class="code" href="../../d9/d21/a00240.html#aafef780987b8990b0ad8f569687de951">v3PixelDown_W</a>;</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;  <span class="comment">// Calculate in-image derivatives of source image pixel motions:</span></div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;  <a class="code" href="../../d7/df2/a00312.html#aa2c30003feb16cfe7454d5bd49e6da04">mm2WarpInverse</a>.T()[0] = m2CamDerivs * (v3MotionRight.slice&lt;0,2&gt;() - v3Cam.slice&lt;0,2&gt;() * v3MotionRight[2] * dOneOverCameraZ) * dOneOverCameraZ;</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;  <a class="code" href="../../d7/df2/a00312.html#aa2c30003feb16cfe7454d5bd49e6da04">mm2WarpInverse</a>.T()[1] = m2CamDerivs * (v3MotionDown.slice&lt;0,2&gt;() - v3Cam.slice&lt;0,2&gt;() * v3MotionDown[2] * dOneOverCameraZ) * dOneOverCameraZ;</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;  <span class="keywordtype">double</span> dDet = <a class="code" href="../../d7/df2/a00312.html#aa2c30003feb16cfe7454d5bd49e6da04">mm2WarpInverse</a>[0][0] * <a class="code" href="../../d7/df2/a00312.html#aa2c30003feb16cfe7454d5bd49e6da04">mm2WarpInverse</a>[1][1] - <a class="code" href="../../d7/df2/a00312.html#aa2c30003feb16cfe7454d5bd49e6da04">mm2WarpInverse</a>[0][1] * <a class="code" href="../../d7/df2/a00312.html#aa2c30003feb16cfe7454d5bd49e6da04">mm2WarpInverse</a>[1][0];</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;  <a class="code" href="../../d7/df2/a00312.html#ab9cf4230e2584d383d07975f658f953b">mnSearchLevel</a> = 0;</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;  </div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;  <span class="comment">// This warp matrix is likely not appropriate for finding at level zero, which is </span></div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;  <span class="comment">// the level at which it has been calculated. Vary the search level until the </span></div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;  <span class="comment">// at that level would be appropriate (does not actually modify the matrix.)</span></div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;  <span class="keywordflow">while</span>(dDet &gt; 3 &amp;&amp; <a class="code" href="../../d7/df2/a00312.html#ab9cf4230e2584d383d07975f658f953b">mnSearchLevel</a> &lt; <a class="code" href="../../d7/d41/a00532.html#a6458dd35f4831329061f763080655cf7">LEVELS</a>-1)</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;    {</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;      <a class="code" href="../../d7/df2/a00312.html#ab9cf4230e2584d383d07975f658f953b">mnSearchLevel</a>++;</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;      dDet *= 0.25;</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;    };</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;  </div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;  <span class="comment">// Some warps are inappropriate, e.g. too near the camera, too far, or reflected, </span></div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;  <span class="comment">// or zero area.. reject these!</span></div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;  <span class="keywordflow">if</span>(dDet &gt; 3 || dDet &lt; 0.25)</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;    {</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;      <a class="code" href="../../d7/df2/a00312.html#ad59f7d0916146d02a7cc9354ece16f38">mbTemplateBad</a> = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;      <span class="keywordflow">return</span> -1;</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;    }</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;  <span class="keywordflow">else</span></div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="../../d7/df2/a00312.html#ab9cf4230e2584d383d07975f658f953b">mnSearchLevel</a>;</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;}</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;<span class="comment">// This is just a convenience function wich caluclates the warp matrix and generates</span></div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;<span class="comment">// the template all in one call.</span></div>
<div class="line"><a name="l00072"></a><span class="lineno"><a class="line" href="../../d7/df2/a00312.html#ac18c27a1e4b82b1ca70f38e7b30e9ca5">   72</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d7/df2/a00312.html#ac18c27a1e4b82b1ca70f38e7b30e9ca5">PatchFinder::MakeTemplateCoarse</a>(<a class="code" href="../../d9/d21/a00240.html">MapPoint</a> &amp;p,</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;                     <a class="code" href="../../df/d73/a00358.html">SE3&lt;&gt;</a> se3CFromW,</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;                     <a class="code" href="../../d6/db6/a00241.html">Matrix&lt;2&gt;</a> &amp;m2CamDerivs)</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;{</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;  <a class="code" href="../../d7/df2/a00312.html#a5229e920912bc780042293dd184dea66">CalcSearchLevelAndWarpMatrix</a>(p, se3CFromW, m2CamDerivs);</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;  <a class="code" href="../../d7/df2/a00312.html#a0741e237872edf9d64e47e46a9e24ce1">MakeTemplateCoarseCont</a>(p);</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;};</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;<span class="comment">// This function generates the warped search template.</span></div>
<div class="line"><a name="l00081"></a><span class="lineno"><a class="line" href="../../d7/df2/a00312.html#a0741e237872edf9d64e47e46a9e24ce1">   81</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d7/df2/a00312.html#a0741e237872edf9d64e47e46a9e24ce1">PatchFinder::MakeTemplateCoarseCont</a>(<a class="code" href="../../d9/d21/a00240.html">MapPoint</a> &amp;p)</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;{</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;  <span class="comment">// Get the warping matrix appropriate for use with CVD::transform...</span></div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;  <a class="code" href="../../d6/db6/a00241.html">Matrix&lt;2&gt;</a> m2 = <a class="code" href="../../de/dde/a00587.html#a6f513aeaffb9f4fe2cbc95d6ae34f330">M2Inverse</a>(<a class="code" href="../../d7/df2/a00312.html#aa2c30003feb16cfe7454d5bd49e6da04">mm2WarpInverse</a>) * <a class="code" href="../../d4/d33/a00536.html#a45d6c59ea32d3126b1479831bac8b90e">LevelScale</a>(<a class="code" href="../../d7/df2/a00312.html#ab9cf4230e2584d383d07975f658f953b">mnSearchLevel</a>); </div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;  <span class="comment">// m2 now represents the number of pixels in the source image for one </span></div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;  <span class="comment">// pixel of template image</span></div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;  </div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;  <span class="comment">// Optimisation: Don&#39;t re-gen the coarse template if it&#39;s going to be substantially the </span></div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;  <span class="comment">// same as was made last time. This saves time when the camera is not moving. For this, </span></div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;  <span class="comment">// check that (a) this patchfinder is still working on the same map point and (b) the </span></div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;  <span class="comment">// warping matrix has not changed much.</span></div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;  </div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;  <span class="keywordtype">bool</span> bNeedToRefreshTemplate = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;  <span class="keywordflow">if</span>(&amp;p != <a class="code" href="../../d7/df2/a00312.html#abf22298b0275d53b8db8e21651f5cc19">mpLastTemplateMapPoint</a>)</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;    bNeedToRefreshTemplate = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;  <span class="comment">// Still the same map point? Then compare warping matrix..</span></div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;  <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0; !bNeedToRefreshTemplate &amp;&amp; i&lt;2; i++)</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;    {</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;      <a class="code" href="../../d9/d69/a00451.html">Vector&lt;2&gt;</a> v2Diff = m2.T()[i] - <a class="code" href="../../d7/df2/a00312.html#aa9a76dbd2f6fb66e700ab7cffebc881d">mm2LastWarpMatrix</a>.T()[i];</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">double</span> dRefreshLimit = 0.07;  <span class="comment">// Sort of works out as half a pixel displacement in src img</span></div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;      <span class="keywordflow">if</span>(v2Diff * v2Diff &gt; dRefreshLimit * dRefreshLimit)</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;    bNeedToRefreshTemplate = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;    }</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;  </div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;  <span class="comment">// Need to regen template? Then go ahead.</span></div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;  <span class="keywordflow">if</span>(bNeedToRefreshTemplate)</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;    {</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;      <span class="keywordtype">int</span> nOutside;  <span class="comment">// Use CVD::transform to warp the patch according the the warping matrix m2</span></div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;                     <span class="comment">// This returns the number of pixels outside the source image hit, which should be zero.</span></div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;      nOutside = <a class="code" href="../../de/d85/a00618.html#adffa5bba45e2953e9525190d02a54764">CVD::transform</a>(p.<a class="code" href="../../d9/d21/a00240.html#a672c3703014d88356b74aab95729522b">pPatchSourceKF</a>-&gt;<a class="code" href="../../dc/d55/a00226.html#a4962879f78735ad057b1e943a36ae9f6">aLevels</a>[p.<a class="code" href="../../d9/d21/a00240.html#a8f25f0ad4b410ee531991e9dbbd212d5">nSourceLevel</a>].<a class="code" href="../../d0/d53/a00232.html#aa2fda57784edbadc7673541d76d32384">im</a>, </div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;                <a class="code" href="../../d7/df2/a00312.html#aed6afefdd4fe1375bdcdb8865c76118a">mimTemplate</a>, </div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;                m2,</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;                <a class="code" href="../../de/d85/a00618.html#a54292001c2bdcba3cc04de6ce55f6735">vec</a>(p.<a class="code" href="../../d9/d21/a00240.html#ae303940d5542eb614c0609ad0681846f">irCenter</a>),</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;                <a class="code" href="../../de/d85/a00618.html#a54292001c2bdcba3cc04de6ce55f6735">vec</a>(<a class="code" href="../../d7/df2/a00312.html#a29d8d47e0bd193dc4d590f6560255d35">mirCenter</a>)); </div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;      </div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;      <span class="keywordflow">if</span>(nOutside)</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;    <a class="code" href="../../d7/df2/a00312.html#ad59f7d0916146d02a7cc9354ece16f38">mbTemplateBad</a> = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;      <span class="keywordflow">else</span></div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;    <a class="code" href="../../d7/df2/a00312.html#ad59f7d0916146d02a7cc9354ece16f38">mbTemplateBad</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;      </div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;      <a class="code" href="../../d7/df2/a00312.html#ae78d6206e12028da50e725cfa3917584">MakeTemplateSums</a>();</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;      </div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;      <span class="comment">// Store the parameters which allow us to determine if we need to re-calculate</span></div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;      <span class="comment">// the patch next time round.</span></div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;      <a class="code" href="../../d7/df2/a00312.html#abf22298b0275d53b8db8e21651f5cc19">mpLastTemplateMapPoint</a> = &amp;p;</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;      <a class="code" href="../../d7/df2/a00312.html#aa9a76dbd2f6fb66e700ab7cffebc881d">mm2LastWarpMatrix</a> = m2;</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;    }</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;};</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;<span class="comment">// This makes a template without warping. Used for epipolar search, where we don&#39;t really know </span></div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;<span class="comment">// what the warping matrix should be. (Although to be fair, I should do rotation for epipolar,</span></div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;<span class="comment">// which we could approximate without knowing patch depth!)</span></div>
<div class="line"><a name="l00133"></a><span class="lineno"><a class="line" href="../../d7/df2/a00312.html#a9313067e51845bbaef5df422b3db8bfc">  133</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d7/df2/a00312.html#aee68ca3c5c899b56b52c4fce7fb177b0">PatchFinder::MakeTemplateCoarseNoWarp</a>(<a class="code" href="../../dc/d55/a00226.html">KeyFrame</a> &amp;k, <span class="keywordtype">int</span> nLevel, <a class="code" href="../../d7/da0/a00198.html">ImageRef</a> irLevelPos)</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;{</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;  <a class="code" href="../../d7/df2/a00312.html#ab9cf4230e2584d383d07975f658f953b">mnSearchLevel</a> = nLevel;</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;  <a class="code" href="../../d7/d6e/a00190.html">Image&lt;byte&gt;</a> &amp;im = k.<a class="code" href="../../dc/d55/a00226.html#a4962879f78735ad057b1e943a36ae9f6">aLevels</a>[nLevel].<a class="code" href="../../d0/d53/a00232.html#aa2fda57784edbadc7673541d76d32384">im</a>;</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;  <span class="keywordflow">if</span>(!im.<a class="code" href="../../d1/d98/a00407.html#a0373930f0671990ed3a8dfef265cc2f5">in_image_with_border</a>(irLevelPos, <a class="code" href="../../d7/df2/a00312.html#a9ac41a306b23e4df6c99240354c7cfe4">mnPatchSize</a> / 2 + 1))</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;    {</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;      <a class="code" href="../../d7/df2/a00312.html#ad59f7d0916146d02a7cc9354ece16f38">mbTemplateBad</a> = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;      <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;    }</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;  <a class="code" href="../../d7/df2/a00312.html#ad59f7d0916146d02a7cc9354ece16f38">mbTemplateBad</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;  <a class="code" href="../../de/d85/a00618.html#a3f6a09c105077594406c9390dfe1de63">copy</a>(im,</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;       <a class="code" href="../../d7/df2/a00312.html#aed6afefdd4fe1375bdcdb8865c76118a">mimTemplate</a>,</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;       <a class="code" href="../../d7/df2/a00312.html#aed6afefdd4fe1375bdcdb8865c76118a">mimTemplate</a>.<a class="code" href="../../d1/d98/a00407.html#a1fe56e4395ac4f7e342c75a222c84e14">size</a>(),</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;       irLevelPos - <a class="code" href="../../d7/df2/a00312.html#a29d8d47e0bd193dc4d590f6560255d35">mirCenter</a>);</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;  </div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;  <a class="code" href="../../d7/df2/a00312.html#ae78d6206e12028da50e725cfa3917584">MakeTemplateSums</a>();</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;}</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;<span class="comment">// Convenient wrapper for the above</span></div>
<div class="line"><a name="l00152"></a><span class="lineno"><a class="line" href="../../d7/df2/a00312.html#aee68ca3c5c899b56b52c4fce7fb177b0">  152</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d7/df2/a00312.html#aee68ca3c5c899b56b52c4fce7fb177b0">PatchFinder::MakeTemplateCoarseNoWarp</a>(<a class="code" href="../../d9/d21/a00240.html">MapPoint</a> &amp;p)</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;{</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;  <a class="code" href="../../d7/df2/a00312.html#aee68ca3c5c899b56b52c4fce7fb177b0">MakeTemplateCoarseNoWarp</a>(*p.<a class="code" href="../../d9/d21/a00240.html#a672c3703014d88356b74aab95729522b">pPatchSourceKF</a>, p.<a class="code" href="../../d9/d21/a00240.html#a8f25f0ad4b410ee531991e9dbbd212d5">nSourceLevel</a>,  p.<a class="code" href="../../d9/d21/a00240.html#ae303940d5542eb614c0609ad0681846f">irCenter</a>);</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;};</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;<span class="comment">// Finds the sum, and sum-squared, of template pixels. These sums are used</span></div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;<span class="comment">// to calculate the ZMSSD.</span></div>
<div class="line"><a name="l00159"></a><span class="lineno"><a class="line" href="../../d7/df2/a00312.html#ae78d6206e12028da50e725cfa3917584">  159</a></span>&#160;<span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="../../d7/df2/a00312.html#ae78d6206e12028da50e725cfa3917584">PatchFinder::MakeTemplateSums</a>()</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;{</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;  <span class="keywordtype">int</span> nSum = 0;</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;  <span class="keywordtype">int</span> nSumSq = 0;</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;  <a class="code" href="../../d7/da0/a00198.html">ImageRef</a> <a class="code" href="../../de/d85/a00618.html#ab323db82d94f28c3a207b04311136a51">ir</a>;</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;  <span class="keywordflow">do</span></div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;    {</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;      <span class="keywordtype">int</span> b = <a class="code" href="../../d7/df2/a00312.html#aed6afefdd4fe1375bdcdb8865c76118a">mimTemplate</a>[<a class="code" href="../../de/d85/a00618.html#ab323db82d94f28c3a207b04311136a51">ir</a>];</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;      nSum += b;</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;      nSumSq +=b * b;</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;    }      </div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;  <span class="keywordflow">while</span>(ir.<a class="code" href="../../d7/da0/a00198.html#a0eb956391ba9f250ee00f15a294dc334">next</a>(<a class="code" href="../../d7/df2/a00312.html#aed6afefdd4fe1375bdcdb8865c76118a">mimTemplate</a>.<a class="code" href="../../d1/d98/a00407.html#a1fe56e4395ac4f7e342c75a222c84e14">size</a>()));</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;  <a class="code" href="../../d7/df2/a00312.html#a3a47c0b63439a14c2cdafee4f998a6f0">mnTemplateSum</a> = nSum;</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;  <a class="code" href="../../d7/df2/a00312.html#a69cbef6faf5930b693d772892b19736a">mnTemplateSumSq</a> = nSumSq;</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;}</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;<span class="comment">// One of the main functions of the class! Looks at the appropriate level of </span></div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;<span class="comment">// the target keyframe to try and find the template. Looks only at FAST corner points</span></div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;<span class="comment">// which are within radius nRange of the center. (Params are supplied in Level0</span></div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;<span class="comment">// coords.) Returns true on patch found.</span></div>
<div class="line"><a name="l00179"></a><span class="lineno"><a class="line" href="../../d7/df2/a00312.html#ab0fd585ba92b6b34eeb3c62ebcc30553">  179</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="../../d7/df2/a00312.html#ab0fd585ba92b6b34eeb3c62ebcc30553">PatchFinder::FindPatchCoarse</a>(<a class="code" href="../../d7/da0/a00198.html">ImageRef</a> irPos, <a class="code" href="../../dc/d55/a00226.html">KeyFrame</a> &amp;kf, <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> nRange)</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;{</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;  <a class="code" href="../../d7/df2/a00312.html#adb73867518fe71d1463083c02b19bcac">mbFound</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;  </div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;  <span class="comment">// Convert from L0 coords to search level quantities</span></div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;  <span class="keywordtype">int</span> nLevelScale = <a class="code" href="../../d4/d33/a00536.html#a45d6c59ea32d3126b1479831bac8b90e">LevelScale</a>(<a class="code" href="../../d7/df2/a00312.html#ab9cf4230e2584d383d07975f658f953b">mnSearchLevel</a>);</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;  <a class="code" href="../../d7/df2/a00312.html#a89ca8e8bd4fdf56a1f6e4f67dd48dc15">mirPredictedPos</a> = irPos;</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;  irPos = irPos / nLevelScale;</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;  nRange = (nRange + nLevelScale - 1) / nLevelScale;</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;  </div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;  <span class="comment">// Bounding box of search circle</span></div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;  <span class="keywordtype">int</span> nTop = irPos.<a class="code" href="../../d7/da0/a00198.html#a8ee9bd31bce429b1b498bb2ff62b7d72">y</a> - nRange;</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;  <span class="keywordtype">int</span> nBottomPlusOne = irPos.<a class="code" href="../../d7/da0/a00198.html#a8ee9bd31bce429b1b498bb2ff62b7d72">y</a> + nRange + 1;</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;  <span class="keywordtype">int</span> nLeft = irPos.<a class="code" href="../../d7/da0/a00198.html#a0a48eec7b69010efb9a67eb0533531aa">x</a> - nRange;</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;  <span class="keywordtype">int</span> nRight = irPos.<a class="code" href="../../d7/da0/a00198.html#a0a48eec7b69010efb9a67eb0533531aa">x</a> + nRange;</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;  </div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;  <span class="comment">// Ref variable for the search level</span></div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;  <a class="code" href="../../d0/d53/a00232.html">Level</a> &amp;L = kf.<a class="code" href="../../dc/d55/a00226.html#a4962879f78735ad057b1e943a36ae9f6">aLevels</a>[<a class="code" href="../../d7/df2/a00312.html#ab9cf4230e2584d383d07975f658f953b">mnSearchLevel</a>];</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;  </div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;  <span class="comment">// Some bounds checks on the bounding box..</span></div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;  <span class="keywordflow">if</span>(nTop &lt; 0)</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;    nTop = 0;</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;  <span class="keywordflow">if</span>(nTop &gt;= L.<a class="code" href="../../d0/d53/a00232.html#aa2fda57784edbadc7673541d76d32384">im</a>.<a class="code" href="../../d1/d98/a00407.html#a1fe56e4395ac4f7e342c75a222c84e14">size</a>().<a class="code" href="../../d7/da0/a00198.html#a8ee9bd31bce429b1b498bb2ff62b7d72">y</a>)</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;  <span class="keywordflow">if</span>(nBottomPlusOne &lt;= 0)</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;  </div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;  <span class="comment">// The next section finds all the FAST corners in the target level which </span></div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;  <span class="comment">// are near enough the search center. It&#39;s a bit optimised to use </span></div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;  <span class="comment">// a corner row look-up-table, since otherwise the routine</span></div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;  <span class="comment">// would spend a long time trawling throught the whole list of FAST corners!</span></div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;  vector&lt;ImageRef&gt;::iterator i;</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;  vector&lt;ImageRef&gt;::iterator i_end;</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;  </div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;  i = L.<a class="code" href="../../d0/d53/a00232.html#a6a78a28fc72de71b2640f6aef2161b07">vCorners</a>.begin() + L.<a class="code" href="../../d0/d53/a00232.html#a472bebefbe0a11eb90c7e7ad60bcf4cd">vCornerRowLUT</a>[nTop];</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;  </div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;  <span class="keywordflow">if</span>(nBottomPlusOne &gt;= L.<a class="code" href="../../d0/d53/a00232.html#aa2fda57784edbadc7673541d76d32384">im</a>.<a class="code" href="../../d1/d98/a00407.html#a1fe56e4395ac4f7e342c75a222c84e14">size</a>().<a class="code" href="../../d7/da0/a00198.html#a8ee9bd31bce429b1b498bb2ff62b7d72">y</a>)</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;    i_end = L.<a class="code" href="../../d0/d53/a00232.html#a6a78a28fc72de71b2640f6aef2161b07">vCorners</a>.end();</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;  <span class="keywordflow">else</span> </div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;    i_end = L.<a class="code" href="../../d0/d53/a00232.html#a6a78a28fc72de71b2640f6aef2161b07">vCorners</a>.begin() + L.<a class="code" href="../../d0/d53/a00232.html#a472bebefbe0a11eb90c7e7ad60bcf4cd">vCornerRowLUT</a>[nBottomPlusOne];</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;  </div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;  <a class="code" href="../../d7/da0/a00198.html">ImageRef</a> irBest;             <span class="comment">// Best match so far</span></div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;  <span class="keywordtype">int</span> nBestSSD = <a class="code" href="../../d7/df2/a00312.html#a4cbaa59c947171f27fafe5fcd0523ba0">mnMaxSSD</a> + 1; <span class="comment">// Best score so far is beyond the max allowed</span></div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;  </div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;  <span class="keywordflow">for</span>(; i&lt;i_end; i++)          <span class="comment">// For each corner ...</span></div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;    {                         </div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;      <span class="keywordflow">if</span>( i-&gt;x &lt; nLeft || i-&gt;x &gt; nRight)</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;        <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;      <span class="keywordflow">if</span>((irPos - *i).mag_squared() &gt; nRange * nRange)</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;    <span class="keywordflow">continue</span>;              <span class="comment">// ... reject all those not close enough..</span></div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;      <span class="keywordtype">int</span> nSSD;                <span class="comment">// .. and find the ZMSSD at those near enough.</span></div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;      nSSD = <a class="code" href="../../d7/df2/a00312.html#adafdd7c5bce8800e2219ed1f34e7f2b3">ZMSSDAtPoint</a>(L.<a class="code" href="../../d0/d53/a00232.html#aa2fda57784edbadc7673541d76d32384">im</a>, *i);</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;      <span class="keywordflow">if</span>(nSSD &lt; nBestSSD)      <span class="comment">// Best yet?</span></div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;    {</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;      irBest = *i;</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;      nBestSSD = nSSD;</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;    }</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;    } <span class="comment">// done looping over corners</span></div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;  </div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;  <span class="keywordflow">if</span>(nBestSSD &lt; <a class="code" href="../../d7/df2/a00312.html#a4cbaa59c947171f27fafe5fcd0523ba0">mnMaxSSD</a>)      <span class="comment">// Found a valid match?</span></div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;    {</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;      <a class="code" href="../../d7/df2/a00312.html#af7327a73a8eaddb3c2a2d5a65b2e4110">mv2CoarsePos</a>= <a class="code" href="../../d4/d33/a00536.html#acc2bcb395bb1daa33db81ad8f7de84a5">LevelZeroPos</a>(irBest, <a class="code" href="../../d7/df2/a00312.html#ab9cf4230e2584d383d07975f658f953b">mnSearchLevel</a>);</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;      <a class="code" href="../../d7/df2/a00312.html#adb73867518fe71d1463083c02b19bcac">mbFound</a> = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;    }</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;  <span class="keywordflow">else</span></div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;    <a class="code" href="../../d7/df2/a00312.html#adb73867518fe71d1463083c02b19bcac">mbFound</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="../../d7/df2/a00312.html#adb73867518fe71d1463083c02b19bcac">mbFound</a>;</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;}</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;<span class="comment">// Makes an inverse composition template out of the coarse template.</span></div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;<span class="comment">// Includes calculating image of derivatives (gradients.) The inverse composition</span></div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;<span class="comment">// used here operates on three variables: x offet, y offset, and difference in patch</span></div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;<span class="comment">// means; hence things like mm3HInv are dim 3, but the trivial mean jacobian </span></div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;<span class="comment">// (always unity, for each pixel) is not stored.</span></div>
<div class="line"><a name="l00254"></a><span class="lineno"><a class="line" href="../../d7/df2/a00312.html#ae420a3f2a92e22913edbc22d937fe6e9">  254</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d7/df2/a00312.html#ae420a3f2a92e22913edbc22d937fe6e9">PatchFinder::MakeSubPixTemplate</a>()</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;{</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;  <a class="code" href="../../d7/df2/a00312.html#a8fb1c17b8c7ad235e8da3e8c5904331e">mimJacs</a>.<a class="code" href="../../d7/d6e/a00190.html#a76a692cdb0afd83cc8f0cfe86813ad6a">resize</a>(<a class="code" href="../../d7/df2/a00312.html#aed6afefdd4fe1375bdcdb8865c76118a">mimTemplate</a>.<a class="code" href="../../d1/d98/a00407.html#a1fe56e4395ac4f7e342c75a222c84e14">size</a>() - <a class="code" href="../../d7/da0/a00198.html">ImageRef</a>(2,2));</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;  <a class="code" href="../../d6/db6/a00241.html">Matrix&lt;3&gt;</a> m3H = <a class="code" href="../../d0/de7/a00523.html#ae9b2cb48b0a8e681b3dd1ac86f8b9d97">Zeros</a>; <span class="comment">// This stores jTj.</span></div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;  <a class="code" href="../../d7/da0/a00198.html">ImageRef</a> <a class="code" href="../../de/d85/a00618.html#ab323db82d94f28c3a207b04311136a51">ir</a>;</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;  <span class="keywordflow">for</span>(ir.<a class="code" href="../../d7/da0/a00198.html#a0a48eec7b69010efb9a67eb0533531aa">x</a> = 1; ir.<a class="code" href="../../d7/da0/a00198.html#a0a48eec7b69010efb9a67eb0533531aa">x</a> &lt; <a class="code" href="../../d7/df2/a00312.html#a9ac41a306b23e4df6c99240354c7cfe4">mnPatchSize</a> - 1; ir.<a class="code" href="../../d7/da0/a00198.html#a0a48eec7b69010efb9a67eb0533531aa">x</a>++)</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;    <span class="keywordflow">for</span>(ir.<a class="code" href="../../d7/da0/a00198.html#a8ee9bd31bce429b1b498bb2ff62b7d72">y</a> = 1; ir.<a class="code" href="../../d7/da0/a00198.html#a8ee9bd31bce429b1b498bb2ff62b7d72">y</a> &lt; <a class="code" href="../../d7/df2/a00312.html#a9ac41a306b23e4df6c99240354c7cfe4">mnPatchSize</a> - 1; ir.<a class="code" href="../../d7/da0/a00198.html#a8ee9bd31bce429b1b498bb2ff62b7d72">y</a>++)</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;      {</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;    <a class="code" href="../../d9/d69/a00451.html">Vector&lt;2&gt;</a> v2Grad;</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;    v2Grad[0] = 0.5 * (<a class="code" href="../../d7/df2/a00312.html#aed6afefdd4fe1375bdcdb8865c76118a">mimTemplate</a>[ir + <a class="code" href="../../d7/da0/a00198.html">ImageRef</a>(1,0)] - <a class="code" href="../../d7/df2/a00312.html#aed6afefdd4fe1375bdcdb8865c76118a">mimTemplate</a>[ir - <a class="code" href="../../d7/da0/a00198.html">ImageRef</a>(1,0)]);</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;    v2Grad[1] = 0.5 * (<a class="code" href="../../d7/df2/a00312.html#aed6afefdd4fe1375bdcdb8865c76118a">mimTemplate</a>[ir + <a class="code" href="../../d7/da0/a00198.html">ImageRef</a>(0,1)] - <a class="code" href="../../d7/df2/a00312.html#aed6afefdd4fe1375bdcdb8865c76118a">mimTemplate</a>[ir - <a class="code" href="../../d7/da0/a00198.html">ImageRef</a>(0,1)]);</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;    <a class="code" href="../../d7/df2/a00312.html#a8fb1c17b8c7ad235e8da3e8c5904331e">mimJacs</a>[ir-<a class="code" href="../../d7/da0/a00198.html">ImageRef</a>(1,1)].first = v2Grad[0];</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;    <a class="code" href="../../d7/df2/a00312.html#a8fb1c17b8c7ad235e8da3e8c5904331e">mimJacs</a>[ir-<a class="code" href="../../d7/da0/a00198.html">ImageRef</a>(1,1)].second = v2Grad[1];</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;    <a class="code" href="../../d9/d69/a00451.html">Vector&lt;3&gt;</a> v3Grad = <a class="code" href="../../d0/de7/a00523.html#addcb08d3afb49cc2c43beb32546b9aa2">unproject</a>(v2Grad); <span class="comment">// This adds the mean-difference jacobian..</span></div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;    m3H += v3Grad.as_col() * v3Grad.as_row(); <span class="comment">// Populate JTJ.</span></div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;      }</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;  </div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;  <span class="comment">// Invert JTJ..</span></div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;  <a class="code" href="../../d2/dee/a00049.html">Cholesky&lt;3&gt;</a> chol(m3H);</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;  <a class="code" href="../../d7/df2/a00312.html#a4bd750446ca0fbbca6c11b8b00961d81">mm3HInv</a> = chol.<a class="code" href="../../d2/dee/a00049.html#adf85bb1a4d9d63e39c0a5b82f9f46ac5">get_inverse</a>();</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;  <span class="comment">// TOON2 Does not have a get_rank for cholesky</span></div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;  <span class="comment">// int nRank = chol.get_rank();</span></div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;  <span class="comment">// if(nRank &lt; 3)</span></div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;  <span class="comment">// cout &lt;&lt; &quot;BAD RANK IN MAKESUBPIXELTEMPLATE!!!!&quot; &lt;&lt; endl; // This does not happen often (almost never!)</span></div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;  </div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;  <a class="code" href="../../d7/df2/a00312.html#a9aae7b0df9810dcdf3143417cfe21560">mv2SubPixPos</a> = <a class="code" href="../../d7/df2/a00312.html#af7327a73a8eaddb3c2a2d5a65b2e4110">mv2CoarsePos</a>; <span class="comment">// Start the sub-pixel search at the result of the coarse search..</span></div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;  <a class="code" href="../../d7/df2/a00312.html#ab0e40de812b5366746f1988aaf708865">mdMeanDiff</a> = 0.0;</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;}</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;<span class="comment">// Iterate inverse composition until convergence. Since it should never have </span></div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;<span class="comment">// to travel more than a pixel&#39;s distance, set a max number of iterations; </span></div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;<span class="comment">// if this is exceeded, consider the IC to have failed.</span></div>
<div class="line"><a name="l00286"></a><span class="lineno"><a class="line" href="../../d7/df2/a00312.html#a8d19042d223df949d37476be75c5c47d">  286</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="../../d7/df2/a00312.html#a8d19042d223df949d37476be75c5c47d">PatchFinder::IterateSubPixToConvergence</a>(<a class="code" href="../../dc/d55/a00226.html">KeyFrame</a> &amp;kf, <span class="keywordtype">int</span> nMaxIts)</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;{</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">double</span> dConvLimit = 0.03;</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;  <span class="keywordtype">bool</span> bConverged = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;  <span class="keywordtype">int</span> nIts;</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;  <span class="keywordflow">for</span>(nIts = 0; nIts &lt; nMaxIts &amp;&amp; !bConverged; nIts++)</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;    {</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;      <span class="keywordtype">double</span> dUpdateSquared = <a class="code" href="../../d7/df2/a00312.html#a96b13d1b72902ee84948e53f822738ae">IterateSubPix</a>(kf);</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;      <span class="keywordflow">if</span>(dUpdateSquared &lt; 0) <span class="comment">// went off edge of image</span></div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;      <span class="keywordflow">if</span>(dUpdateSquared &lt; dConvLimit*dConvLimit)</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;    }</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;}</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;<span class="comment">// Single iteration of inverse composition. This compares integral image positions in the </span></div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;<span class="comment">// template image to floating point positions in the target keyframe. Interpolation is</span></div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;<span class="comment">// bilinear, and performed manually (rather than using CVD::image_interpolate) since </span></div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;<span class="comment">// this is a special case where the mixing fractions for each pixel are identical.</span></div>
<div class="line"><a name="l00306"></a><span class="lineno"><a class="line" href="../../d7/df2/a00312.html#a96b13d1b72902ee84948e53f822738ae">  306</a></span>&#160;<span class="keywordtype">double</span> <a class="code" href="../../d7/df2/a00312.html#a96b13d1b72902ee84948e53f822738ae">PatchFinder::IterateSubPix</a>(<a class="code" href="../../dc/d55/a00226.html">KeyFrame</a> &amp;kf)</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;{</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;  <span class="comment">// Search level pos of patch center</span></div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;  <a class="code" href="../../d9/d69/a00451.html">Vector&lt;2&gt;</a> v2Center = <a class="code" href="../../d4/d33/a00536.html#a1869091ab20eb8319313c0f829969f5a">LevelNPos</a>(<a class="code" href="../../d7/df2/a00312.html#a9aae7b0df9810dcdf3143417cfe21560">mv2SubPixPos</a>, <a class="code" href="../../d7/df2/a00312.html#ab9cf4230e2584d383d07975f658f953b">mnSearchLevel</a>);</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;  <a class="code" href="../../dc/d87/a00032.html">BasicImage&lt;byte&gt;</a> &amp;im = kf.<a class="code" href="../../dc/d55/a00226.html#a4962879f78735ad057b1e943a36ae9f6">aLevels</a>[<a class="code" href="../../d7/df2/a00312.html#ab9cf4230e2584d383d07975f658f953b">mnSearchLevel</a>].<a class="code" href="../../d0/d53/a00232.html#aa2fda57784edbadc7673541d76d32384">im</a>;</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;  <span class="keywordflow">if</span>(!im.<a class="code" href="../../d1/d98/a00407.html#a0373930f0671990ed3a8dfef265cc2f5">in_image_with_border</a>(<a class="code" href="../../de/d85/a00618.html#a68b6ddc8a27058be99ca964f9c8a46a6">ir_rounded</a>(v2Center), <a class="code" href="../../d7/df2/a00312.html#a9ac41a306b23e4df6c99240354c7cfe4">mnPatchSize</a> / 2 + 1))</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;    <span class="keywordflow">return</span> -1.0;       <span class="comment">// Negative return value indicates off edge of image </span></div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;  </div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;  <span class="comment">// Position of top-left corner of patch in search level</span></div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;  <a class="code" href="../../d9/d69/a00451.html">Vector&lt;2&gt;</a> v2Base = v2Center - <a class="code" href="../../de/d85/a00618.html#a54292001c2bdcba3cc04de6ce55f6735">vec</a>(<a class="code" href="../../d7/df2/a00312.html#a29d8d47e0bd193dc4d590f6560255d35">mirCenter</a>);</div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;  </div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;  <span class="comment">// I.C. JT*d accumulator</span></div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;  <a class="code" href="../../d9/d69/a00451.html">Vector&lt;3&gt;</a> v3Accum = <a class="code" href="../../d0/de7/a00523.html#ae9b2cb48b0a8e681b3dd1ac86f8b9d97">Zeros</a>;</div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;  </div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;  <a class="code" href="../../d7/da0/a00198.html">ImageRef</a> <a class="code" href="../../de/d85/a00618.html#ab323db82d94f28c3a207b04311136a51">ir</a>;</div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;  </div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;  <a class="code" href="../../de/d85/a00618.html#a4677daaef2a68ec1a8bb62729bd3e2eb">byte</a>* pTopLeftPixel;</div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;  </div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;  <span class="comment">// Each template pixel will be compared to an interpolated target pixel</span></div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;  <span class="comment">// The target value is made using bilinear interpolation as the weighted sum</span></div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;  <span class="comment">// of four target image pixels. Calculate mixing fractions:</span></div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;  <span class="keywordtype">double</span> dX = v2Base[0]-floor(v2Base[0]); <span class="comment">// Distances from pixel center of TL pixel</span></div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;  <span class="keywordtype">double</span> dY = v2Base[1]-floor(v2Base[1]);</div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;  <span class="keywordtype">float</span> fMixTL = (1.0 - dX) * (1.0 - dY);</div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;  <span class="keywordtype">float</span> fMixTR = (dX)       * (1.0 - dY);</div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;  <span class="keywordtype">float</span> fMixBL = (1.0 - dX) * (dY);</div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;  <span class="keywordtype">float</span> fMixBR = (dX)       * (dY);</div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;  </div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;  <span class="comment">// Loop over template image</span></div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> nRowOffset = &amp;kf.<a class="code" href="../../dc/d55/a00226.html#a4962879f78735ad057b1e943a36ae9f6">aLevels</a>[<a class="code" href="../../d7/df2/a00312.html#ab9cf4230e2584d383d07975f658f953b">mnSearchLevel</a>].<a class="code" href="../../d0/d53/a00232.html#aa2fda57784edbadc7673541d76d32384">im</a>[<a class="code" href="../../d7/da0/a00198.html">ImageRef</a>(0,1)] - &amp;kf.<a class="code" href="../../dc/d55/a00226.html#a4962879f78735ad057b1e943a36ae9f6">aLevels</a>[<a class="code" href="../../d7/df2/a00312.html#ab9cf4230e2584d383d07975f658f953b">mnSearchLevel</a>].<a class="code" href="../../d0/d53/a00232.html#aa2fda57784edbadc7673541d76d32384">im</a>[<a class="code" href="../../d7/da0/a00198.html">ImageRef</a>(0,0)];</div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;  <span class="keywordflow">for</span>(ir.<a class="code" href="../../d7/da0/a00198.html#a8ee9bd31bce429b1b498bb2ff62b7d72">y</a> = 1; ir.<a class="code" href="../../d7/da0/a00198.html#a8ee9bd31bce429b1b498bb2ff62b7d72">y</a> &lt; <a class="code" href="../../d7/df2/a00312.html#a9ac41a306b23e4df6c99240354c7cfe4">mnPatchSize</a> - 1; ir.<a class="code" href="../../d7/da0/a00198.html#a8ee9bd31bce429b1b498bb2ff62b7d72">y</a>++)</div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;    {</div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;      pTopLeftPixel = &amp;im[<a class="code" href="../../de/d85/a00618.html#ab323db82d94f28c3a207b04311136a51">::ir</a>(v2Base) + <a class="code" href="../../d7/da0/a00198.html">ImageRef</a>(1,ir.<a class="code" href="../../d7/da0/a00198.html#a8ee9bd31bce429b1b498bb2ff62b7d72">y</a>)]; <span class="comment">// n.b. the x=1 offset, as with y</span></div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;      <span class="keywordflow">for</span>(ir.<a class="code" href="../../d7/da0/a00198.html#a0a48eec7b69010efb9a67eb0533531aa">x</a> = 1; ir.<a class="code" href="../../d7/da0/a00198.html#a0a48eec7b69010efb9a67eb0533531aa">x</a> &lt; <a class="code" href="../../d7/df2/a00312.html#a9ac41a306b23e4df6c99240354c7cfe4">mnPatchSize</a> - 1; ir.<a class="code" href="../../d7/da0/a00198.html#a0a48eec7b69010efb9a67eb0533531aa">x</a>++)</div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;    {</div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;      <span class="keywordtype">float</span> fPixel =   <span class="comment">// Calc target interpolated pixel</span></div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;        fMixTL * pTopLeftPixel[0]          + fMixTR * pTopLeftPixel[1] + </div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;        fMixBL * pTopLeftPixel[nRowOffset] + fMixBR * pTopLeftPixel[nRowOffset + 1];</div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;      pTopLeftPixel++;</div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;      <span class="keywordtype">double</span> dDiff = fPixel - <a class="code" href="../../d7/df2/a00312.html#aed6afefdd4fe1375bdcdb8865c76118a">mimTemplate</a>[<a class="code" href="../../de/d85/a00618.html#ab323db82d94f28c3a207b04311136a51">ir</a>] + <a class="code" href="../../d7/df2/a00312.html#ab0e40de812b5366746f1988aaf708865">mdMeanDiff</a>;</div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;      v3Accum[0] += dDiff * <a class="code" href="../../d7/df2/a00312.html#a8fb1c17b8c7ad235e8da3e8c5904331e">mimJacs</a>[ir - <a class="code" href="../../d7/da0/a00198.html">ImageRef</a>(1,1)].first;</div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;      v3Accum[1] += dDiff * <a class="code" href="../../d7/df2/a00312.html#a8fb1c17b8c7ad235e8da3e8c5904331e">mimJacs</a>[ir - <a class="code" href="../../d7/da0/a00198.html">ImageRef</a>(1,1)].second;</div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;      v3Accum[2] += dDiff;  <span class="comment">// Update JT*d</span></div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;    };</div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;    }</div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;  </div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;  <span class="comment">// All done looping over image - find JTJ^-1 * JTd:</span></div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;  <a class="code" href="../../d9/d69/a00451.html">Vector&lt;3&gt;</a> v3Update = <a class="code" href="../../d7/df2/a00312.html#a4bd750446ca0fbbca6c11b8b00961d81">mm3HInv</a> * v3Accum; </div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;  <a class="code" href="../../d7/df2/a00312.html#a9aae7b0df9810dcdf3143417cfe21560">mv2SubPixPos</a> -= v3Update.slice&lt;0,2&gt;() * <a class="code" href="../../d4/d33/a00536.html#a45d6c59ea32d3126b1479831bac8b90e">LevelScale</a>(<a class="code" href="../../d7/df2/a00312.html#ab9cf4230e2584d383d07975f658f953b">mnSearchLevel</a>);</div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;  <a class="code" href="../../d7/df2/a00312.html#ab0e40de812b5366746f1988aaf708865">mdMeanDiff</a> -= v3Update[2];</div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;  </div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;  <span class="keywordtype">double</span> dPixelUpdateSquared = v3Update.slice&lt;0,2&gt;() * v3Update.slice&lt;0,2&gt;();</div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;  <span class="keywordflow">return</span> dPixelUpdateSquared;</div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;}</div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;</div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;<span class="comment">// </span></div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;<span class="comment">//              ZMSSDatpoint, which is SSE optimised, follows</span></div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;<span class="comment">// The top version is the SSE version for 8x8 patches. It is compiled</span></div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;<span class="comment">// only if CVD_HAVE_XMMINTRIN is true, also you need to give your </span></div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;<span class="comment">// compiler the appropriate flags (e.g. -march=core2 -msse3 for g++.)</span></div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;<span class="comment">// The standard c++ version, which is about half as quick (not a disaster</span></div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;<span class="comment">// by any means) is below.</span></div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;<span class="comment">// The 8x8 SSE version looks long because it has been unrolled, </span></div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;<span class="comment">// it just does the same thing eight times. Both versions are one-pass</span></div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;<span class="comment">// and need pre-calculated template sums and sum-squares.</span></div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;<span class="preprocessor">#if CVD_HAVE_XMMINTRIN</span></div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;<span class="comment">// Horizontal sum of uint16s stored in an XMM register</span></div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;<span class="keyword">inline</span> <span class="keywordtype">int</span> SumXMM_16(__m128i &amp;target)</div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;{</div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> <span class="keywordtype">int</span> sums_store[8];    </div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;  _mm_storeu_si128((__m128i*)sums_store, target);</div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;  <span class="keywordflow">return</span> sums_store[0] + sums_store[1] + sums_store[2] + sums_store[3] +</div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;    sums_store[4] + sums_store[5] + sums_store[6] + sums_store[7];</div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;}</div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;<span class="comment">// Horizontal sum of uint32s stored in an XMM register</span></div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;<span class="keyword">inline</span> <span class="keywordtype">int</span> SumXMM_32(__m128i &amp;target)</div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;{</div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> sums_store[4];    </div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;  _mm_storeu_si128((__m128i*)sums_store, target);</div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;  <span class="keywordflow">return</span> sums_store[0] + sums_store[1] + sums_store[2] + sums_store[3];</div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;}</div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;</div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;<span class="comment">// Calculate the Zero-mean SSD of the coarse patch and a target imate at a specific </span></div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;<span class="comment">// point.</span></div>
<div class="line"><a name="l00400"></a><span class="lineno"><a class="line" href="../../d7/df2/a00312.html#adafdd7c5bce8800e2219ed1f34e7f2b3">  400</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="../../d7/df2/a00312.html#adafdd7c5bce8800e2219ed1f34e7f2b3">PatchFinder::ZMSSDAtPoint</a>(<a class="code" href="../../dc/d87/a00032.html">CVD::BasicImage&lt;CVD::byte&gt;</a> &amp;im, <span class="keyword">const</span> <a class="code" href="../../d7/da0/a00198.html">CVD::ImageRef</a> &amp;<a class="code" href="../../de/d85/a00618.html#ab323db82d94f28c3a207b04311136a51">ir</a>)</div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;{</div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;  <span class="keywordflow">if</span>(!im.<a class="code" href="../../d1/d98/a00407.html#a0373930f0671990ed3a8dfef265cc2f5">in_image_with_border</a>(ir, <a class="code" href="../../d7/df2/a00312.html#a29d8d47e0bd193dc4d590f6560255d35">mirCenter</a>[0]))</div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="../../d7/df2/a00312.html#a4cbaa59c947171f27fafe5fcd0523ba0">mnMaxSSD</a> + 1;</div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;  </div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;  <a class="code" href="../../d7/da0/a00198.html">ImageRef</a> irImgBase = ir - <a class="code" href="../../d7/df2/a00312.html#a29d8d47e0bd193dc4d590f6560255d35">mirCenter</a>;</div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;  <a class="code" href="../../de/d85/a00618.html#a4677daaef2a68ec1a8bb62729bd3e2eb">byte</a> *imagepointer;</div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;  <a class="code" href="../../de/d85/a00618.html#a4677daaef2a68ec1a8bb62729bd3e2eb">byte</a> *templatepointer;</div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;  </div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;  <span class="keywordtype">int</span> nImageSumSq = 0;</div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;  <span class="keywordtype">int</span> nImageSum = 0;</div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;  <span class="keywordtype">int</span> nCrossSum = 0;</div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;</div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;<span class="preprocessor">#if CVD_HAVE_XMMINTRIN</span></div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="../../d7/df2/a00312.html#a9ac41a306b23e4df6c99240354c7cfe4">mnPatchSize</a> == 8)</div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;    {</div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;      <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> imagepointerincrement;</div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;</div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;      __m128i xImageAsEightBytes;</div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;      __m128i xImageAsWords;</div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;      __m128i xTemplateAsEightBytes;</div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;      __m128i xTemplateAsWords;</div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;      __m128i xZero;</div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;      __m128i xImageSums; <span class="comment">// These sums are 8xuint16</span></div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;      __m128i xImageSqSums; <span class="comment">// These sums are 4xint32</span></div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;      __m128i xCrossSums;   <span class="comment">// These sums are 4xint32</span></div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;      __m128i xProduct;</div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;</div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;      </div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;      xImageSums = _mm_setzero_si128();</div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;      xImageSqSums = _mm_setzero_si128();</div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;      xCrossSums = _mm_setzero_si128();</div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;      xZero = _mm_setzero_si128();</div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;      </div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;      imagepointer = &amp;im[irImgBase + <a class="code" href="../../d7/da0/a00198.html">ImageRef</a>(0,0)];</div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;      templatepointer = &amp;<a class="code" href="../../d7/df2/a00312.html#aed6afefdd4fe1375bdcdb8865c76118a">mimTemplate</a>[<a class="code" href="../../d7/da0/a00198.html">ImageRef</a>(0,0)];</div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;      imagepointerincrement = &amp;im[irImgBase + <a class="code" href="../../d7/da0/a00198.html">ImageRef</a>(0,1)] - imagepointer;</div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;      </div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;      xImageAsEightBytes=_mm_loadl_epi64((__m128i*) imagepointer);</div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;      imagepointer += imagepointerincrement;</div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;      xImageAsWords = _mm_unpacklo_epi8(xImageAsEightBytes,xZero);</div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;      xImageSums = _mm_adds_epu16(xImageAsWords,xImageSums);</div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;      xProduct = _mm_madd_epi16(xImageAsWords, xImageAsWords);</div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;      xImageSqSums = _mm_add_epi32(xProduct, xImageSqSums);</div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;      xTemplateAsEightBytes=_mm_load_si128((__m128i*) templatepointer);</div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;      templatepointer += 16;</div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;      xTemplateAsWords = _mm_unpacklo_epi8(xTemplateAsEightBytes,xZero);</div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;      xProduct = _mm_madd_epi16(xImageAsWords, xTemplateAsWords);</div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;      xCrossSums = _mm_add_epi32(xProduct, xCrossSums);</div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;      xImageAsEightBytes=_mm_loadl_epi64((__m128i*) imagepointer);</div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;      imagepointer += imagepointerincrement;</div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;      xImageAsWords = _mm_unpacklo_epi8(xImageAsEightBytes,xZero);</div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;      xImageSums = _mm_adds_epu16(xImageAsWords,xImageSums);</div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;      xProduct = _mm_madd_epi16(xImageAsWords, xImageAsWords);</div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;      xImageSqSums = _mm_add_epi32(xProduct, xImageSqSums);</div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;      xTemplateAsWords = _mm_unpackhi_epi8(xTemplateAsEightBytes,xZero);</div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;      xProduct = _mm_madd_epi16(xImageAsWords, xTemplateAsWords);</div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;      xCrossSums = _mm_add_epi32(xProduct, xCrossSums);</div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;</div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;      xImageAsEightBytes=_mm_loadl_epi64((__m128i*) imagepointer);</div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;      imagepointer += imagepointerincrement;</div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;      xImageAsWords = _mm_unpacklo_epi8(xImageAsEightBytes,xZero);</div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;      xImageSums = _mm_adds_epu16(xImageAsWords,xImageSums);</div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;      xProduct = _mm_madd_epi16(xImageAsWords, xImageAsWords);</div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;      xImageSqSums = _mm_add_epi32(xProduct, xImageSqSums);</div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;      xTemplateAsEightBytes=_mm_load_si128((__m128i*) templatepointer);</div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;      templatepointer += 16;</div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;      xTemplateAsWords = _mm_unpacklo_epi8(xTemplateAsEightBytes,xZero);</div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;      xProduct = _mm_madd_epi16(xImageAsWords, xTemplateAsWords);</div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;      xCrossSums = _mm_add_epi32(xProduct, xCrossSums);</div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;      xImageAsEightBytes=_mm_loadl_epi64((__m128i*) imagepointer);</div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;      imagepointer += imagepointerincrement;</div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;      xImageAsWords = _mm_unpacklo_epi8(xImageAsEightBytes,xZero);</div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;      xImageSums = _mm_adds_epu16(xImageAsWords,xImageSums);</div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;      xProduct = _mm_madd_epi16(xImageAsWords, xImageAsWords);</div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;      xImageSqSums = _mm_add_epi32(xProduct, xImageSqSums);</div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;      xTemplateAsWords = _mm_unpackhi_epi8(xTemplateAsEightBytes,xZero);</div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;      xProduct = _mm_madd_epi16(xImageAsWords, xTemplateAsWords);</div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;      xCrossSums = _mm_add_epi32(xProduct, xCrossSums);</div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;</div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;      xImageAsEightBytes=_mm_loadl_epi64((__m128i*) imagepointer);</div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;      imagepointer += imagepointerincrement;</div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;      xImageAsWords = _mm_unpacklo_epi8(xImageAsEightBytes,xZero);</div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;      xImageSums = _mm_adds_epu16(xImageAsWords,xImageSums);</div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;      xProduct = _mm_madd_epi16(xImageAsWords, xImageAsWords);</div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;      xImageSqSums = _mm_add_epi32(xProduct, xImageSqSums);</div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;      xTemplateAsEightBytes=_mm_load_si128((__m128i*) templatepointer);</div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;      templatepointer += 16;</div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;      xTemplateAsWords = _mm_unpacklo_epi8(xTemplateAsEightBytes,xZero);</div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;      xProduct = _mm_madd_epi16(xImageAsWords, xTemplateAsWords);</div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;      xCrossSums = _mm_add_epi32(xProduct, xCrossSums);</div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;      xImageAsEightBytes=_mm_loadl_epi64((__m128i*) imagepointer);</div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;      imagepointer += imagepointerincrement;</div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;      xImageAsWords = _mm_unpacklo_epi8(xImageAsEightBytes,xZero);</div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;      xImageSums = _mm_adds_epu16(xImageAsWords,xImageSums);</div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;      xProduct = _mm_madd_epi16(xImageAsWords, xImageAsWords);</div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;      xImageSqSums = _mm_add_epi32(xProduct, xImageSqSums);</div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;      xTemplateAsWords = _mm_unpackhi_epi8(xTemplateAsEightBytes,xZero);</div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;      xProduct = _mm_madd_epi16(xImageAsWords, xTemplateAsWords);</div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;      xCrossSums = _mm_add_epi32(xProduct, xCrossSums);</div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;</div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;      xImageAsEightBytes=_mm_loadl_epi64((__m128i*) imagepointer);</div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;      imagepointer += imagepointerincrement;</div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;      xImageAsWords = _mm_unpacklo_epi8(xImageAsEightBytes,xZero);</div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;      xImageSums = _mm_adds_epu16(xImageAsWords,xImageSums);</div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;      xProduct = _mm_madd_epi16(xImageAsWords, xImageAsWords);</div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;      xImageSqSums = _mm_add_epi32(xProduct, xImageSqSums);</div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;      xTemplateAsEightBytes=_mm_load_si128((__m128i*) templatepointer);</div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;      templatepointer += 16;</div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;      xTemplateAsWords = _mm_unpacklo_epi8(xTemplateAsEightBytes,xZero);</div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;      xProduct = _mm_madd_epi16(xImageAsWords, xTemplateAsWords);</div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;      xCrossSums = _mm_add_epi32(xProduct, xCrossSums);</div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;      xImageAsEightBytes=_mm_loadl_epi64((__m128i*) imagepointer);</div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;      xImageAsWords = _mm_unpacklo_epi8(xImageAsEightBytes,xZero);</div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;      xImageSums = _mm_adds_epu16(xImageAsWords,xImageSums);</div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;      xProduct = _mm_madd_epi16(xImageAsWords, xImageAsWords);</div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;      xImageSqSums = _mm_add_epi32(xProduct, xImageSqSums);</div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;      xTemplateAsWords = _mm_unpackhi_epi8(xTemplateAsEightBytes,xZero);</div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;      xProduct = _mm_madd_epi16(xImageAsWords, xTemplateAsWords);</div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;      xCrossSums = _mm_add_epi32(xProduct, xCrossSums);</div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;</div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;      nImageSum = SumXMM_16(xImageSums);</div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;      nCrossSum = SumXMM_32(xCrossSums);</div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;      nImageSumSq = SumXMM_32(xImageSqSums);</div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;    }</div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;  <span class="keywordflow">else</span></div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;<span class="preprocessor">#endif </span></div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;    {    </div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;      <span class="keywordflow">for</span>(<span class="keywordtype">int</span> nRow = 0; nRow &lt; <a class="code" href="../../d7/df2/a00312.html#a9ac41a306b23e4df6c99240354c7cfe4">mnPatchSize</a>; nRow++)</div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;    {</div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;      imagepointer = &amp;im[irImgBase + <a class="code" href="../../d7/da0/a00198.html">ImageRef</a>(0,nRow)];</div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;      templatepointer = &amp;<a class="code" href="../../d7/df2/a00312.html#aed6afefdd4fe1375bdcdb8865c76118a">mimTemplate</a>[<a class="code" href="../../d7/da0/a00198.html">ImageRef</a>(0,nRow)];</div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;      <span class="keywordflow">for</span>(<span class="keywordtype">int</span> nCol = 0; nCol &lt; <a class="code" href="../../d7/df2/a00312.html#a9ac41a306b23e4df6c99240354c7cfe4">mnPatchSize</a>; nCol++)</div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;        {</div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;          <span class="keywordtype">int</span> n = imagepointer[nCol];</div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;          nImageSum += n;</div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;          nImageSumSq += n*n;</div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;          nCrossSum += n * templatepointer[nCol];</div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;        };</div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;    }</div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;    };</div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;  </div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;  <span class="keywordtype">int</span> SA = <a class="code" href="../../d7/df2/a00312.html#a3a47c0b63439a14c2cdafee4f998a6f0">mnTemplateSum</a>;</div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;  <span class="keywordtype">int</span> SB = nImageSum;</div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;  </div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;  <span class="keywordtype">int</span> N = <a class="code" href="../../d7/df2/a00312.html#a9ac41a306b23e4df6c99240354c7cfe4">mnPatchSize</a> * <a class="code" href="../../d7/df2/a00312.html#a9ac41a306b23e4df6c99240354c7cfe4">mnPatchSize</a>;</div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;  <span class="keywordflow">return</span> ((2*SA*SB - SA*SA - SB*SB)/N + nImageSumSq + <a class="code" href="../../d7/df2/a00312.html#a69cbef6faf5930b693d772892b19736a">mnTemplateSumSq</a> - 2*nCrossSum);</div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;}</div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;</div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;</div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;</div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;</div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;</div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;</div>
<div class="ttc" id="a00240_html_ab3effcd7c9d1c6b8ad36c900fa36f391"><div class="ttname"><a href="../../d9/d21/a00240.html#ab3effcd7c9d1c6b8ad36c900fa36f391">MapPoint::v3PixelRight_W</a></div><div class="ttdeci">Vector&lt; 3 &gt; v3PixelRight_W</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/ddf/a00544_source.html#l00060">MapPoint.h:60</a></div></div>
<div class="ttc" id="a00312_html_a9aae7b0df9810dcdf3143417cfe21560"><div class="ttname"><a href="../../d7/df2/a00312.html#a9aae7b0df9810dcdf3143417cfe21560">PatchFinder::mv2SubPixPos</a></div><div class="ttdeci">Vector&lt; 2 &gt; mv2SubPixPos</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d95/a00556_source.html#l00122">PatchFinder.h:122</a></div></div>
<div class="ttc" id="a00312_html_aa9a76dbd2f6fb66e700ab7cffebc881d"><div class="ttname"><a href="../../d7/df2/a00312.html#aa9a76dbd2f6fb66e700ab7cffebc881d">PatchFinder::mm2LastWarpMatrix</a></div><div class="ttdeci">Matrix&lt; 2 &gt; mm2LastWarpMatrix</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d95/a00556_source.html#l00133">PatchFinder.h:133</a></div></div>
<div class="ttc" id="a00198_html_a8ee9bd31bce429b1b498bb2ff62b7d72"><div class="ttname"><a href="../../d7/da0/a00198.html#a8ee9bd31bce429b1b498bb2ff62b7d72">CVD::ImageRef::y</a></div><div class="ttdeci">int y</div><div class="ttdoc">The y co-ordinate. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d81/a00528_source.html#l00180">image_ref.h:180</a></div></div>
<div class="ttc" id="a00198_html_a0a48eec7b69010efb9a67eb0533531aa"><div class="ttname"><a href="../../d7/da0/a00198.html#a0a48eec7b69010efb9a67eb0533531aa">CVD::ImageRef::x</a></div><div class="ttdeci">int x</div><div class="ttdoc">The x co-ordinate. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d81/a00528_source.html#l00179">image_ref.h:179</a></div></div>
<div class="ttc" id="a00536_html_a45d6c59ea32d3126b1479831bac8b90e"><div class="ttname"><a href="../../d4/d33/a00536.html#a45d6c59ea32d3126b1479831bac8b90e">LevelScale</a></div><div class="ttdeci">int LevelScale(int nLevel)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d33/a00536_source.html#l00020">LevelHelpers.h:20</a></div></div>
<div class="ttc" id="a00610_html"><div class="ttname"><a href="../../da/d6e/a00610.html">vector_image_ref.h</a></div></div>
<div class="ttc" id="a00536_html_a1869091ab20eb8319313c0f829969f5a"><div class="ttname"><a href="../../d4/d33/a00536.html#a1869091ab20eb8319313c0f829969f5a">LevelNPos</a></div><div class="ttdeci">double LevelNPos(double dRootPos, int nLevel)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d33/a00536_source.html#l00048">LevelHelpers.h:48</a></div></div>
<div class="ttc" id="a00312_html_a96b13d1b72902ee84948e53f822738ae"><div class="ttname"><a href="../../d7/df2/a00312.html#a96b13d1b72902ee84948e53f822738ae">PatchFinder::IterateSubPix</a></div><div class="ttdeci">double IterateSubPix(KeyFrame &amp;kf)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d75/a00555_source.html#l00306">PatchFinder.cpp:306</a></div></div>
<div class="ttc" id="a00312_html_ab0fd585ba92b6b34eeb3c62ebcc30553"><div class="ttname"><a href="../../d7/df2/a00312.html#ab0fd585ba92b6b34eeb3c62ebcc30553">PatchFinder::FindPatchCoarse</a></div><div class="ttdeci">bool FindPatchCoarse(CVD::ImageRef ir, KeyFrame &amp;kf, unsigned int nRange)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d75/a00555_source.html#l00179">PatchFinder.cpp:179</a></div></div>
<div class="ttc" id="a00556_html"><div class="ttname"><a href="../../d6/d95/a00556.html">PatchFinder.h</a></div></div>
<div class="ttc" id="a00527_html"><div class="ttname"><a href="../../d9/d44/a00527.html">image_interpolate.h</a></div></div>
<div class="ttc" id="a00358_html_a6f349984d701630586ac4955c35733f7"><div class="ttname"><a href="../../df/d73/a00358.html#a6f349984d701630586ac4955c35733f7">TooN::SE3::get_rotation</a></div><div class="ttdeci">SO3&lt; Precision &gt; &amp; get_rotation()</div><div class="ttdoc">Returns the rotation part of the transformation as a SO3. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d21/a00573_source.html#l00064">se3.h:64</a></div></div>
<div class="ttc" id="a00523_html_a33cfd229bb53b4055e430bd993782d41"><div class="ttname"><a href="../../d0/de7/a00523.html#a33cfd229bb53b4055e430bd993782d41">TooN::Identity</a></div><div class="ttdeci">static Operator&lt; Internal::Identity&lt; Internal::One &gt; &gt; Identity</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/de9/a00552_source.html#l00748">objects.h:748</a></div></div>
<div class="ttc" id="a00312_html_a89ca8e8bd4fdf56a1f6e4f67dd48dc15"><div class="ttname"><a href="../../d7/df2/a00312.html#a89ca8e8bd4fdf56a1f6e4f67dd48dc15">PatchFinder::mirPredictedPos</a></div><div class="ttdeci">CVD::ImageRef mirPredictedPos</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d95/a00556_source.html#l00125">PatchFinder.h:125</a></div></div>
<div class="ttc" id="a00190_html_a76a692cdb0afd83cc8f0cfe86813ad6a"><div class="ttname"><a href="../../d7/d6e/a00190.html#a76a692cdb0afd83cc8f0cfe86813ad6a">CVD::Image::resize</a></div><div class="ttdeci">void resize(const ImageRef &amp;size)</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d35/a00526_source.html#l00749">image.h:749</a></div></div>
<div class="ttc" id="a00312_html_a3a47c0b63439a14c2cdafee4f998a6f0"><div class="ttname"><a href="../../d7/df2/a00312.html#a3a47c0b63439a14c2cdafee4f998a6f0">PatchFinder::mnTemplateSum</a></div><div class="ttdeci">int mnTemplateSum</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d95/a00556_source.html#l00112">PatchFinder.h:112</a></div></div>
<div class="ttc" id="a00532_html_a6458dd35f4831329061f763080655cf7"><div class="ttname"><a href="../../d7/d41/a00532.html#a6458dd35f4831329061f763080655cf7">LEVELS</a></div><div class="ttdeci">#define LEVELS</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d41/a00532_source.html#l00033">KeyFrame.h:33</a></div></div>
<div class="ttc" id="a00312_html_af7327a73a8eaddb3c2a2d5a65b2e4110"><div class="ttname"><a href="../../d7/df2/a00312.html#af7327a73a8eaddb3c2a2d5a65b2e4110">PatchFinder::mv2CoarsePos</a></div><div class="ttdeci">Vector&lt; 2 &gt; mv2CoarsePos</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d95/a00556_source.html#l00126">PatchFinder.h:126</a></div></div>
<div class="ttc" id="a00519_html_a5409e0f5857087147caf55556c36ff22"><div class="ttname"><a href="../../dd/d4d/a00519.html#a5409e0f5857087147caf55556c36ff22">nMaxSSDPerPixel</a></div><div class="ttdeci">const int nMaxSSDPerPixel</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d4d/a00519_source.html#l00044">globals.h:44</a></div></div>
<div class="ttc" id="a00312_html_ab0e40de812b5366746f1988aaf708865"><div class="ttname"><a href="../../d7/df2/a00312.html#ab0e40de812b5366746f1988aaf708865">PatchFinder::mdMeanDiff</a></div><div class="ttdeci">double mdMeanDiff</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d95/a00556_source.html#l00123">PatchFinder.h:123</a></div></div>
<div class="ttc" id="a00312_html_aee68ca3c5c899b56b52c4fce7fb177b0"><div class="ttname"><a href="../../d7/df2/a00312.html#aee68ca3c5c899b56b52c4fce7fb177b0">PatchFinder::MakeTemplateCoarseNoWarp</a></div><div class="ttdeci">void MakeTemplateCoarseNoWarp(MapPoint &amp;p)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d75/a00555_source.html#l00152">PatchFinder.cpp:152</a></div></div>
<div class="ttc" id="a00312_html_a9ac41a306b23e4df6c99240354c7cfe4"><div class="ttname"><a href="../../d7/df2/a00312.html#a9ac41a306b23e4df6c99240354c7cfe4">PatchFinder::mnPatchSize</a></div><div class="ttdeci">int mnPatchSize</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d95/a00556_source.html#l00109">PatchFinder.h:109</a></div></div>
<div class="ttc" id="a00618_html_a54292001c2bdcba3cc04de6ce55f6735"><div class="ttname"><a href="../../de/d85/a00618.html#a54292001c2bdcba3cc04de6ce55f6735">CVD::vec</a></div><div class="ttdeci">TooN::Vector&lt; 2 &gt; vec(const ImageRef &amp;ir)</div><div class="ttdef"><b>Definition:</b> <a href="../../da/d6e/a00610_source.html#l00032">vector_image_ref.h:32</a></div></div>
<div class="ttc" id="a00232_html_aa2fda57784edbadc7673541d76d32384"><div class="ttname"><a href="../../d0/d53/a00232.html#aa2fda57784edbadc7673541d76d32384">Level::im</a></div><div class="ttdeci">CVD::Image&lt; CVD::byte &gt; im</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d41/a00532_source.html#l00059">KeyFrame.h:59</a></div></div>
<div class="ttc" id="a00618_html_a68b6ddc8a27058be99ca964f9c8a46a6"><div class="ttname"><a href="../../de/d85/a00618.html#a68b6ddc8a27058be99ca964f9c8a46a6">CVD::ir_rounded</a></div><div class="ttdeci">ImageRef ir_rounded(const TooN::Vector&lt; 2 &gt; &amp;v)</div><div class="ttdef"><b>Definition:</b> <a href="../../da/d6e/a00610_source.html#l00051">vector_image_ref.h:51</a></div></div>
<div class="ttc" id="a00312_html_ae420a3f2a92e22913edbc22d937fe6e9"><div class="ttname"><a href="../../d7/df2/a00312.html#ae420a3f2a92e22913edbc22d937fe6e9">PatchFinder::MakeSubPixTemplate</a></div><div class="ttdeci">void MakeSubPixTemplate()</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d75/a00555_source.html#l00254">PatchFinder.cpp:254</a></div></div>
<div class="ttc" id="a00312_html_a8fb1c17b8c7ad235e8da3e8c5904331e"><div class="ttname"><a href="../../d7/df2/a00312.html#a8fb1c17b8c7ad235e8da3e8c5904331e">PatchFinder::mimJacs</a></div><div class="ttdeci">CVD::Image&lt; std::pair&lt; float, float &gt; &gt; mimJacs</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d95/a00556_source.html#l00117">PatchFinder.h:117</a></div></div>
<div class="ttc" id="a00523_html_addcb08d3afb49cc2c43beb32546b9aa2"><div class="ttname"><a href="../../d0/de7/a00523.html#addcb08d3afb49cc2c43beb32546b9aa2">TooN::unproject</a></div><div class="ttdeci">Vector&lt;(Size==Dynamic?Dynamic:Size+1), Precision &gt; unproject(const Vector&lt; Size, Precision, Base &gt; &amp;v)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d14/a00522_source.html#l00166">helpers.h:166</a></div></div>
<div class="ttc" id="a00312_html_a4bd750446ca0fbbca6c11b8b00961d81"><div class="ttname"><a href="../../d7/df2/a00312.html#a4bd750446ca0fbbca6c11b8b00961d81">PatchFinder::mm3HInv</a></div><div class="ttdeci">Matrix&lt; 3 &gt; mm3HInv</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d95/a00556_source.html#l00121">PatchFinder.h:121</a></div></div>
<div class="ttc" id="a00312_html_a5229e920912bc780042293dd184dea66"><div class="ttname"><a href="../../d7/df2/a00312.html#a5229e920912bc780042293dd184dea66">PatchFinder::CalcSearchLevelAndWarpMatrix</a></div><div class="ttdeci">int CalcSearchLevelAndWarpMatrix(MapPoint &amp;p, SE3&lt;&gt; se3CFromW, Matrix&lt; 2 &gt; &amp;m2CamDerivs)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d75/a00555_source.html#l00033">PatchFinder.cpp:33</a></div></div>
<div class="ttc" id="a00618_html"><div class="ttname"><a href="../../de/d85/a00618.html">CVD</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d34/a00476_source.html#l00024">abs.h:24</a></div></div>
<div class="ttc" id="a00241_html"><div class="ttname"><a href="../../d6/db6/a00241.html">TooN::Matrix&lt; 2 &gt;</a></div></div>
<div class="ttc" id="a00618_html_a3f6a09c105077594406c9390dfe1de63"><div class="ttname"><a href="../../de/d85/a00618.html#a3f6a09c105077594406c9390dfe1de63">CVD::copy</a></div><div class="ttdeci">void copy(const BasicImage&lt; S &gt; &amp;in, BasicImage&lt; T &gt; &amp;out, ImageRef size=ImageRef(-1,-1), ImageRef begin=ImageRef(), ImageRef dst=ImageRef())</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d75/a00604_source.html#l00026">utility.h:26</a></div></div>
<div class="ttc" id="a00312_html_a37582462db3e8284d4df8dffa867b9a5"><div class="ttname"><a href="../../d7/df2/a00312.html#a37582462db3e8284d4df8dffa867b9a5">PatchFinder::PatchFinder</a></div><div class="ttdeci">PatchFinder(int nPatchSize=8)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d75/a00555_source.html#l00019">PatchFinder.cpp:19</a></div></div>
<div class="ttc" id="a00312_html_a29d8d47e0bd193dc4d590f6560255d35"><div class="ttname"><a href="../../d7/df2/a00312.html#a29d8d47e0bd193dc4d590f6560255d35">PatchFinder::mirCenter</a></div><div class="ttdeci">CVD::ImageRef mirCenter</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d95/a00556_source.html#l00127">PatchFinder.h:127</a></div></div>
<div class="ttc" id="a00487_html"><div class="ttname"><a href="../../dd/d9c/a00487.html">Cholesky.h</a></div></div>
<div class="ttc" id="a00049_html_adf85bb1a4d9d63e39c0a5b82f9f46ac5"><div class="ttname"><a href="../../d2/dee/a00049.html#adf85bb1a4d9d63e39c0a5b82f9f46ac5">TooN::Cholesky::get_inverse</a></div><div class="ttdeci">Matrix&lt; Size, Size, Precision &gt; get_inverse()</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d9c/a00487_source.html#l00196">Cholesky.h:196</a></div></div>
<div class="ttc" id="a00587_html"><div class="ttname"><a href="../../de/dde/a00587.html">SmallMatrixOpts.h</a></div></div>
<div class="ttc" id="a00312_html_a4cbaa59c947171f27fafe5fcd0523ba0"><div class="ttname"><a href="../../d7/df2/a00312.html#a4cbaa59c947171f27fafe5fcd0523ba0">PatchFinder::mnMaxSSD</a></div><div class="ttdeci">int mnMaxSSD</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d95/a00556_source.html#l00103">PatchFinder.h:103</a></div></div>
<div class="ttc" id="a00312_html_a8d19042d223df949d37476be75c5c47d"><div class="ttname"><a href="../../d7/df2/a00312.html#a8d19042d223df949d37476be75c5c47d">PatchFinder::IterateSubPixToConvergence</a></div><div class="ttdeci">bool IterateSubPixToConvergence(KeyFrame &amp;kf, int nMaxIts)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d75/a00555_source.html#l00286">PatchFinder.cpp:286</a></div></div>
<div class="ttc" id="a00190_html"><div class="ttname"><a href="../../d7/d6e/a00190.html">CVD::Image</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d35/a00526_source.html#l00617">image.h:617</a></div></div>
<div class="ttc" id="a00198_html_a0eb956391ba9f250ee00f15a294dc334"><div class="ttname"><a href="../../d7/da0/a00198.html#a0eb956391ba9f250ee00f15a294dc334">CVD::ImageRef::next</a></div><div class="ttdeci">bool next(const ImageRef &amp;max)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d81/a00528_source.html#l00220">image_ref.h:220</a></div></div>
<div class="ttc" id="a00226_html"><div class="ttname"><a href="../../dc/d55/a00226.html">KeyFrame</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d41/a00532_source.html#l00076">KeyFrame.h:76</a></div></div>
<div class="ttc" id="a00226_html_a4962879f78735ad057b1e943a36ae9f6"><div class="ttname"><a href="../../dc/d55/a00226.html#a4962879f78735ad057b1e943a36ae9f6">KeyFrame::aLevels</a></div><div class="ttdeci">Level aLevels[LEVELS]</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d41/a00532_source.html#l00084">KeyFrame.h:84</a></div></div>
<div class="ttc" id="a00240_html_a8f25f0ad4b410ee531991e9dbbd212d5"><div class="ttname"><a href="../../d9/d21/a00240.html#a8f25f0ad4b410ee531991e9dbbd212d5">MapPoint::nSourceLevel</a></div><div class="ttdeci">int nSourceLevel</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/ddf/a00544_source.html#l00047">MapPoint.h:47</a></div></div>
<div class="ttc" id="a00240_html_ae303940d5542eb614c0609ad0681846f"><div class="ttname"><a href="../../d9/d21/a00240.html#ae303940d5542eb614c0609ad0681846f">MapPoint::irCenter</a></div><div class="ttdeci">CVD::ImageRef irCenter</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/ddf/a00544_source.html#l00048">MapPoint.h:48</a></div></div>
<div class="ttc" id="a00240_html_aafef780987b8990b0ad8f569687de951"><div class="ttname"><a href="../../d9/d21/a00240.html#aafef780987b8990b0ad8f569687de951">MapPoint::v3PixelDown_W</a></div><div class="ttdeci">Vector&lt; 3 &gt; v3PixelDown_W</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/ddf/a00544_source.html#l00059">MapPoint.h:59</a></div></div>
<div class="ttc" id="a00232_html_a6a78a28fc72de71b2640f6aef2161b07"><div class="ttname"><a href="../../d0/d53/a00232.html#a6a78a28fc72de71b2640f6aef2161b07">Level::vCorners</a></div><div class="ttdeci">std::vector&lt; CVD::ImageRef &gt; vCorners</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d41/a00532_source.html#l00062">KeyFrame.h:62</a></div></div>
<div class="ttc" id="a00587_html_a6f513aeaffb9f4fe2cbc95d6ae34f330"><div class="ttname"><a href="../../de/dde/a00587.html#a6f513aeaffb9f4fe2cbc95d6ae34f330">M2Inverse</a></div><div class="ttdeci">Matrix&lt; 2 &gt; M2Inverse(const Matrix&lt; 2 &gt; &amp;m)</div><div class="ttdef"><b>Definition:</b> <a href="../../de/dde/a00587_source.html#l00010">SmallMatrixOpts.h:10</a></div></div>
<div class="ttc" id="a00358_html"><div class="ttname"><a href="../../df/d73/a00358.html">TooN::SE3</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d21/a00573_source.html#l00050">se3.h:50</a></div></div>
<div class="ttc" id="a00618_html_adffa5bba45e2953e9525190d02a54764"><div class="ttname"><a href="../../de/d85/a00618.html#adffa5bba45e2953e9525190d02a54764">CVD::transform</a></div><div class="ttdeci">int transform(const BasicImage&lt; S &gt; &amp;in, BasicImage&lt; T &gt; &amp;out, const TooN::Matrix&lt; 2 &gt; &amp;M, const TooN::Vector&lt; 2 &gt; &amp;inOrig, const TooN::Vector&lt; 2 &gt; &amp;outOrig, const T defaultValue=T())</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/dc0/a00611_source.html#l00304">vision.h:304</a></div></div>
<div class="ttc" id="a00312_html_aed6afefdd4fe1375bdcdb8865c76118a"><div class="ttname"><a href="../../d7/df2/a00312.html#aed6afefdd4fe1375bdcdb8865c76118a">PatchFinder::mimTemplate</a></div><div class="ttdeci">CVD::Image&lt; CVD::byte &gt; mimTemplate</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d95/a00556_source.html#l00116">PatchFinder.h:116</a></div></div>
<div class="ttc" id="a00312_html_ab9cf4230e2584d383d07975f658f953b"><div class="ttname"><a href="../../d7/df2/a00312.html#ab9cf4230e2584d383d07975f658f953b">PatchFinder::mnSearchLevel</a></div><div class="ttdeci">int mnSearchLevel</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d95/a00556_source.html#l00120">PatchFinder.h:120</a></div></div>
<div class="ttc" id="a00240_html_a03926fa19108aea2b524e8a244853eb7"><div class="ttname"><a href="../../d9/d21/a00240.html#a03926fa19108aea2b524e8a244853eb7">MapPoint::v3WorldPos</a></div><div class="ttdeci">Vector&lt; 3 &gt; v3WorldPos</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/ddf/a00544_source.html#l00038">MapPoint.h:38</a></div></div>
<div class="ttc" id="a00032_html"><div class="ttname"><a href="../../dc/d87/a00032.html">CVD::BasicImage</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d35/a00526_source.html#l00471">image.h:471</a></div></div>
<div class="ttc" id="a00232_html"><div class="ttname"><a href="../../d0/d53/a00232.html">Level</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d41/a00532_source.html#l00054">KeyFrame.h:54</a></div></div>
<div class="ttc" id="a00632_html"><div class="ttname"><a href="../../d4/d2a/a00632.html">std</a></div></div>
<div class="ttc" id="a00532_html"><div class="ttname"><a href="../../d7/d41/a00532.html">KeyFrame.h</a></div></div>
<div class="ttc" id="a00407_html_a1fe56e4395ac4f7e342c75a222c84e14"><div class="ttname"><a href="../../d1/d98/a00407.html#a1fe56e4395ac4f7e342c75a222c84e14">CVD::SubImage::size</a></div><div class="ttdeci">ImageRef size() const </div><div class="ttdoc">What is the size of this image? </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d35/a00526_source.html#l00370">image.h:370</a></div></div>
<div class="ttc" id="a00049_html"><div class="ttname"><a href="../../d2/dee/a00049.html">TooN::Cholesky</a></div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d9c/a00487_source.html#l00069">Cholesky.h:69</a></div></div>
<div class="ttc" id="a00407_html_a0373930f0671990ed3a8dfef265cc2f5"><div class="ttname"><a href="../../d1/d98/a00407.html#a0373930f0671990ed3a8dfef265cc2f5">CVD::SubImage::in_image_with_border</a></div><div class="ttdeci">bool in_image_with_border(const ImageRef &amp;ir, int border) const </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d35/a00526_source.html#l00271">image.h:271</a></div></div>
<div class="ttc" id="a00312_html_aa2c30003feb16cfe7454d5bd49e6da04"><div class="ttname"><a href="../../d7/df2/a00312.html#aa2c30003feb16cfe7454d5bd49e6da04">PatchFinder::mm2WarpInverse</a></div><div class="ttdeci">Matrix&lt; 2 &gt; mm2WarpInverse</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d95/a00556_source.html#l00119">PatchFinder.h:119</a></div></div>
<div class="ttc" id="a00312_html_ad59f7d0916146d02a7cc9354ece16f38"><div class="ttname"><a href="../../d7/df2/a00312.html#ad59f7d0916146d02a7cc9354ece16f38">PatchFinder::mbTemplateBad</a></div><div class="ttdeci">bool mbTemplateBad</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d95/a00556_source.html#l00129">PatchFinder.h:129</a></div></div>
<div class="ttc" id="a00618_html_ab323db82d94f28c3a207b04311136a51"><div class="ttname"><a href="../../de/d85/a00618.html#ab323db82d94f28c3a207b04311136a51">CVD::ir</a></div><div class="ttdeci">ImageRef ir(const TooN::Vector&lt; 2 &gt; &amp;v)</div><div class="ttdef"><b>Definition:</b> <a href="../../da/d6e/a00610_source.html#l00043">vector_image_ref.h:43</a></div></div>
<div class="ttc" id="a00232_html_a472bebefbe0a11eb90c7e7ad60bcf4cd"><div class="ttname"><a href="../../d0/d53/a00232.html#a472bebefbe0a11eb90c7e7ad60bcf4cd">Level::vCornerRowLUT</a></div><div class="ttdeci">std::vector&lt; int &gt; vCornerRowLUT</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d41/a00532_source.html#l00063">KeyFrame.h:63</a></div></div>
<div class="ttc" id="a00312_html_adafdd7c5bce8800e2219ed1f34e7f2b3"><div class="ttname"><a href="../../d7/df2/a00312.html#adafdd7c5bce8800e2219ed1f34e7f2b3">PatchFinder::ZMSSDAtPoint</a></div><div class="ttdeci">int ZMSSDAtPoint(CVD::BasicImage&lt; CVD::byte &gt; &amp;im, const CVD::ImageRef &amp;ir)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d75/a00555_source.html#l00400">PatchFinder.cpp:400</a></div></div>
<div class="ttc" id="a00312_html_adb73867518fe71d1463083c02b19bcac"><div class="ttname"><a href="../../d7/df2/a00312.html#adb73867518fe71d1463083c02b19bcac">PatchFinder::mbFound</a></div><div class="ttdeci">bool mbFound</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d95/a00556_source.html#l00128">PatchFinder.h:128</a></div></div>
<div class="ttc" id="a00240_html"><div class="ttname"><a href="../../d9/d21/a00240.html">MapPoint</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/ddf/a00544_source.html#l00027">MapPoint.h:27</a></div></div>
<div class="ttc" id="a00618_html_a4677daaef2a68ec1a8bb62729bd3e2eb"><div class="ttname"><a href="../../de/d85/a00618.html#a4677daaef2a68ec1a8bb62729bd3e2eb">CVD::byte</a></div><div class="ttdeci">unsigned char byte</div><div class="ttdef"><b>Definition:</b> <a href="../../db/df1/a00486_source.html#l00028">byte.h:28</a></div></div>
<div class="ttc" id="a00611_html"><div class="ttname"><a href="../../dd/dc0/a00611.html">vision.h</a></div></div>
<div class="ttc" id="a00198_html"><div class="ttname"><a href="../../d7/da0/a00198.html">CVD::ImageRef</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d81/a00528_source.html#l00047">image_ref.h:47</a></div></div>
<div class="ttc" id="a00240_html_a672c3703014d88356b74aab95729522b"><div class="ttname"><a href="../../d9/d21/a00240.html#a672c3703014d88356b74aab95729522b">MapPoint::pPatchSourceKF</a></div><div class="ttdeci">KeyFrame * pPatchSourceKF</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/ddf/a00544_source.html#l00046">MapPoint.h:46</a></div></div>
<div class="ttc" id="a00312_html_ae78d6206e12028da50e725cfa3917584"><div class="ttname"><a href="../../d7/df2/a00312.html#ae78d6206e12028da50e725cfa3917584">PatchFinder::MakeTemplateSums</a></div><div class="ttdeci">void MakeTemplateSums()</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d75/a00555_source.html#l00159">PatchFinder.cpp:159</a></div></div>
<div class="ttc" id="a00312_html_abf22298b0275d53b8db8e21651f5cc19"><div class="ttname"><a href="../../d7/df2/a00312.html#abf22298b0275d53b8db8e21651f5cc19">PatchFinder::mpLastTemplateMapPoint</a></div><div class="ttdeci">MapPoint * mpLastTemplateMapPoint</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d95/a00556_source.html#l00132">PatchFinder.h:132</a></div></div>
<div class="ttc" id="a00312_html_ac18c27a1e4b82b1ca70f38e7b30e9ca5"><div class="ttname"><a href="../../d7/df2/a00312.html#ac18c27a1e4b82b1ca70f38e7b30e9ca5">PatchFinder::MakeTemplateCoarse</a></div><div class="ttdeci">void MakeTemplateCoarse(MapPoint &amp;p, SE3&lt;&gt; se3CFromW, Matrix&lt; 2 &gt; &amp;m2CamDerivs)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d75/a00555_source.html#l00072">PatchFinder.cpp:72</a></div></div>
<div class="ttc" id="a00536_html_acc2bcb395bb1daa33db81ad8f7de84a5"><div class="ttname"><a href="../../d4/d33/a00536.html#acc2bcb395bb1daa33db81ad8f7de84a5">LevelZeroPos</a></div><div class="ttdeci">double LevelZeroPos(double dLevelPos, int nLevel)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d33/a00536_source.html#l00026">LevelHelpers.h:26</a></div></div>
<div class="ttc" id="a00451_html"><div class="ttname"><a href="../../d9/d69/a00451.html">TooN::Vector&lt; 3 &gt;</a></div></div>
<div class="ttc" id="a00312_html_a0741e237872edf9d64e47e46a9e24ce1"><div class="ttname"><a href="../../d7/df2/a00312.html#a0741e237872edf9d64e47e46a9e24ce1">PatchFinder::MakeTemplateCoarseCont</a></div><div class="ttdeci">void MakeTemplateCoarseCont(MapPoint &amp;p)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d75/a00555_source.html#l00081">PatchFinder.cpp:81</a></div></div>
<div class="ttc" id="a00523_html_ae9b2cb48b0a8e681b3dd1ac86f8b9d97"><div class="ttname"><a href="../../d0/de7/a00523.html#ae9b2cb48b0a8e681b3dd1ac86f8b9d97">TooN::Zeros</a></div><div class="ttdeci">static Operator&lt; Internal::Zero &gt; Zeros</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/de9/a00552_source.html#l00727">objects.h:727</a></div></div>
<div class="ttc" id="a00312_html_a69cbef6faf5930b693d772892b19736a"><div class="ttname"><a href="../../d7/df2/a00312.html#a69cbef6faf5930b693d772892b19736a">PatchFinder::mnTemplateSumSq</a></div><div class="ttdeci">int mnTemplateSumSq</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d95/a00556_source.html#l00113">PatchFinder.h:113</a></div></div>
</div><!-- fragment --></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Mon May 25 2015 17:53:29 for SLAMflex SE by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="../../doxygen.png" alt="doxygen"/>
</a> 1.8.9.1
</small></address>
</body>
</html>
